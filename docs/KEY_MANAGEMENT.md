Night Core Key Management
Version

Night Core Console v1.0.0-beta

1. Purpose of This Document

This document defines how cryptographic keys are generated, stored, used, rotated, and revoked in Night Core.

It exists to:

Make trust boundaries explicit

Allow independent security review

Prevent accidental misuse

Set realistic expectations

Night Core’s security model depends on correct key handling.
This document assumes operators treat keys as sensitive assets.

2. Key Types in Night Core

Night Core uses multiple key classes, each with a distinct purpose.

2.1 Maintainer Keys

Ed25519 private keys

Used to sign trusted tenant modules

Represent human or organizational authority

Highest trust level

2.2 GUI Signing Key

Ed25519 private key generated by the GUI

Used only when a human explicitly approves an action

Scoped to a single installation

2.3 Public Verification Keys

Derived from maintainer or GUI keys

Stored alongside modules

Used only for verification

Not sensitive

Night Core does not use shared or global signing keys.

3. Key Algorithms

Algorithm: Ed25519

Hashing: SHA-256

Encoding: Base64 (for storage and transport)

Rationale:

Ed25519 provides deterministic signatures, small key sizes, and strong security properties.

SHA-256 is used for integrity and audit correlation, not authentication.

No custom cryptography is used.

4. Key Generation
4.1 Maintainer Keys

Maintainer keys are generated externally or via Night Core tooling.

Requirements:

Secure random source

One key per maintainer identity

Never generated automatically without operator intent

Maintainer keys should be generated offline if possible.

4.2 GUI Signing Key

The GUI generates its own signing key on first use.

Properties:

Generated locally

Stored only on that system

Never transmitted

Never reused across machines

If the GUI key is deleted, it is regenerated.

5. Key Storage Locations
5.1 Worker Keys
worker/
└── keys/
    ├── maintainers/
    │   └── admin1.key
    └── gui/
        └── gui_private.key

5.2 Permissions

Recommended permissions:

Private keys: readable only by the Night Core user

Public keys: readable by Night Core only

Night Core does not manage OS-level permissions automatically.

6. Key Usage Rules
6.1 Maintainer Keys

Used to sign production or trusted modules

Used during controlled onboarding

Not used automatically

Not exposed to the GUI by default

6.2 GUI Signing Key

Used only after a human clicks “Approve”

Used for agent ingress approval

Used for manual tenant approval

Never used for unattended automation

6.3 Verification Keys

Used only to verify signatures

Never used to sign anything

Night Core enforces signature checks before execution.

7. Trust Implications

A valid signature means:

A known key signed the module

The module was not modified after signing

A valid signature does not mean:

The module is safe

The module is correct

The module is trusted forever

Trust is time-bound and policy-bound.

8. Key Rotation

Night Core does not rotate keys automatically.

Recommended rotation procedure:

Generate a new key

Add the new public key to policy allow-lists

Re-sign active modules

Remove old key references

Securely destroy old private keys

Old signatures remain valid until policies change.

9. Key Revocation

Revocation is policy-based.

To revoke a key:

Remove it from allowed signer lists

Quarantine or disable affected tenants

Optionally rotate keys

Night Core does not rely on certificate revocation lists or online checks.

10. Compromise Handling

If a private key is compromised:

Assume all signatures from that key are untrusted

Immediately revoke the key in policy

Re-sign affected tenants

Review logs for misuse

Night Core logs signature verification events for audit.

11. Agent Ingress and Keys

Agent-submitted modules:

Enter through the Inbox

Are unsigned initially

Cannot execute without approval

Must be signed explicitly

This ensures:

Agents cannot self-authorize execution

Human intent is always recorded

12. Key Backup and Recovery

Recommendations:

Back up maintainer keys securely

Do not back up GUI signing keys

Store backups offline

Encrypt backups at rest

Loss of a maintainer key requires re-signing.

Loss of a GUI key only affects approvals.

13. What Night Core Does Not Do

Night Core does not:

Act as a PKI

Manage certificates

Provide key escrow

Sync keys across systems

Enforce hardware key storage

These are operator responsibilities.

14. Audit and Visibility

All signature verification results are logged.

Logs include:

Tenant name

SHA-256 hash

Signature status

Execution outcome

Logs are append-only by design.

15. Security Boundaries Summary

Keys define authority.
Policies define enforcement.
Logs define accountability.

Breaking any one weakens the system.

16. Related Documents

SECURITY_ARCHITECTURE.md

TRUST_MODEL.md

AUDIT_LOGGING.md

INCIDENT_RESPONSE.md

OPERATIONAL_SECURITY.md

COMPLIANCE_AND_LIMITATIONS.md

DEPLOYMENT_GUIDE.md